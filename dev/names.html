

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Names and Paths &mdash; dantalian 0.5-dev documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="dantalian 0.5-dev documentation" href="../index.html" />
    <link rel="up" title="Developer Guide" href="../dev.html" />
    <link rel="next" title="Library Operations" href="libop.html" />
    <link rel="prev" title="The Library Abstraction" href="library.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="libop.html" title="Library Operations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="library.html" title="The Library Abstraction"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">dantalian 0.5-dev documentation</a> &raquo;</li>
          <li><a href="../dev.html" accesskey="U">Developer Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="names-and-paths">
<span id="names"></span><h1>Names and Paths<a class="headerlink" href="#names-and-paths" title="Permalink to this headline">¶</a></h1>
<div class="section" id="files">
<h2>Files<a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h2>
<p>Everything is done internally via inodes, so all operations take
filenames only as a way to indicate a particular file/inode, and
dantalian works with that.  Thus, file naming is for the most part a
concern for the user only.</p>
</div>
<div class="section" id="file-renaming-algorithm">
<span id="rename-alg"></span><h2>File Renaming Algorithm<a class="headerlink" href="#file-renaming-algorithm" title="Permalink to this headline">¶</a></h2>
<p>When dantalian needs to add a file to a directory (e.g., when renaming
or tagging), it will attempt to use the name of the file directly.  If
it runs into a filename/path conflict, it will then attempt to generate
a new name using the algorithm described below:</p>
<div class="highlight-python"><pre>def resolve(dir, name):
   base, extension = split_extension(name)
   for i=1; ; i++:
      new_name = &#x27;.&#x27;.join([base, i, extension])
      if is_okay(dir, new_name):
         return new_name</pre>
</div>
<p>If between generating the new name and using it the name becomes
unavailable, dantalian will try to generate a name again using the
original name.</p>
</div>
<div class="section" id="fuse-name-collision-resolution">
<h2>FUSE Name Collision Resolution<a class="headerlink" href="#fuse-name-collision-resolution" title="Permalink to this headline">¶</a></h2>
<p>When file names are projected in a FUSE mounted library, there is a high
chance of name collisions, in which case the virtual names of affected
files are changed with the following algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">fuse_resolve</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
   <span class="n">base</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">split_extension</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
   <span class="n">new_name</span> <span class="o">=</span> <span class="s">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">base</span><span class="p">,</span> <span class="n">get_inode_number</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">extension</span><span class="p">])</span>
   <span class="k">return</span> <span class="n">new_name</span>
</pre></div>
</div>
<p>In practice there will be no further name collisions, but if there are,
then name collision resolution will be propagated outward until there
are no name collisions.  This state is guaranteed as file systems cannot
assign the same inode number to two different files.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Names and Paths</a><ul>
<li><a class="reference internal" href="#files">Files</a></li>
<li><a class="reference internal" href="#file-renaming-algorithm">File Renaming Algorithm</a></li>
<li><a class="reference internal" href="#fuse-name-collision-resolution">FUSE Name Collision Resolution</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="library.html"
                        title="previous chapter">The Library Abstraction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="libop.html"
                        title="next chapter">Library Operations</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/dev/names.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="libop.html" title="Library Operations"
             >next</a> |</li>
        <li class="right" >
          <a href="library.html" title="The Library Abstraction"
             >previous</a> |</li>
        <li><a href="../index.html">dantalian 0.5-dev documentation</a> &raquo;</li>
          <li><a href="../dev.html" >Developer Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, darkfeline.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>