

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Library Specification &mdash; dantalian 0.5-dev documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="dantalian 0.5-dev documentation" href="../index.html" />
    <link rel="up" title="Developer Guide" href="../dev.html" />
    <link rel="next" title="Library Implementation" href="libop.html" />
    <link rel="prev" title="Building" href="build.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="libop.html" title="Library Implementation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="build.html" title="Building"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">dantalian 0.5-dev documentation</a> &raquo;</li>
          <li><a href="../dev.html" accesskey="U">Developer Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="library-specification">
<span id="library-spec"></span><h1>Library Specification<a class="headerlink" href="#library-specification" title="Permalink to this headline">¶</a></h1>
<p>dantalian is an implementation of the dantalian library, an abstract
interface.  Much like how POSIX system calls define an interface
providing a standard file system interface abstraction, the dantalian
library defines a standard interface for a multidimensionally
hierarchical tagging system.</p>
<p>dantalian provides a transparent implementation of the library that lies
closely on top of the underlying file system.  Details pertaining to
dantalian&#8217;s library implementation will be listed separately below in
the notes.</p>
<div class="section" id="library-sublayer">
<h2>Library Sublayer<a class="headerlink" href="#library-sublayer" title="Permalink to this headline">¶</a></h2>
<p>Libraries require a single POSIX filesystem underneath them to manage
the files.  Libraries only manage the tag metadata.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">dantalian&#8217;s implementation anchors the library on a root directory
given by an absolute path on the file system, but the general library
specification has no such requirement.</p>
</div>
</div>
<div class="section" id="library-objects">
<h2>Library objects<a class="headerlink" href="#library-objects" title="Permalink to this headline">¶</a></h2>
<p>Libraries interact with files (including directories) and tags.  Both
are described with strings.</p>
<p>Tags start with <tt class="docutils literal"><span class="pre">//</span></tt>, similar to absolute paths, but doubled to
distinguish them.  Like POSIX paths, parent and child tags are separated
with <tt class="docutils literal"><span class="pre">/</span></tt>.  <tt class="docutils literal"><span class="pre">/</span></tt> is not allowed in tag names, but all other characters
are legal.</p>
<p>Files are identified by their path, in standard POSIX format.  However,
paths starting with <tt class="docutils literal"><span class="pre">//</span></tt> are not legal, since that is reserved for
tags.  Libraries handle files by their inode.  Thus, if a file is moved,
it maintains its status in the library, but must be referred to with its
new path.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Tags are directories in dantalian&#8217;s library implementation.  Thus,
tags and directories (as files) may be referenced interchangeably as
a file or a tag, respectively.</p>
<p>Directories are considered tags relative to the library root.  Thus,
a directory <tt class="docutils literal"><span class="pre">albums</span></tt> in the root directory is synonymous with tag
<tt class="docutils literal"><span class="pre">//albums</span></tt>, and a directory <tt class="docutils literal"><span class="pre">artists</span></tt> in <tt class="docutils literal"><span class="pre">albums</span></tt> with tag
<tt class="docutils literal"><span class="pre">//albums/artists</span></tt>.</p>
<p class="last">Due to dantalian&#8217;s implementation, the special root tag <tt class="docutils literal"><span class="pre">//</span></tt> exists
as an implementation detail.  The only documented appearance of the
root tag is when calling
<tt class="xref py py-meth docutils literal"><span class="pre">dantalian.library.BaseLibrary.listtag()</span></tt>, which will include
the root tag if the file is hard linked under the library root
directory.  The root tag will work everywhere a tag will, but again,
is an implementation detail specific to dantalian&#8217;s implementation.</p>
</div>
</div>
<div class="section" id="tagging">
<h2>Tagging<a class="headerlink" href="#tagging" title="Permalink to this headline">¶</a></h2>
<p>Libraries allow objects to be associated with tags and track these
associations.</p>
<p>Both files and tags may be tagged.  Each object can have any number and
any combination of tags.  Each object can only be tagged with a given
tag once; the relationship is binary, either tagged or untagged.  Tags
can be tagged with themselves.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Directories can only be tagged once by virtue of common file system
limitations.  Symbolic links act identically to files.  In order to
tag a directory multiple times in dantalian&#8217;s library implementation,
the directory must be converted (stored in a designated location and
replaced with a corresponding symbolic link).  If a file system
were to support directory hard links, then the library specification
applies normally.</p>
</div>
</div>
<div class="section" id="library-class-and-methods">
<span id="library-class"></span><h2>Library class and methods<a class="headerlink" href="#library-class-and-methods" title="Permalink to this headline">¶</a></h2>
<p>The library interface is defined in the
<tt class="xref py py-class docutils literal"><span class="pre">dantalian.library.BaseLibrary</span></tt> class.  Library implementation
must implement the following methods:</p>
<dl class="method">
<dt>
<tt class="descname">tag</tt><big>(</big><em>file</em>, <em>tag</em><big>)</big></dt>
<dd><p><cite>file</cite> should be tagged with <cite>tag</cite> after call, regardless of whether
it was before.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">untag</tt><big>(</big><em>file</em>, <em>tag</em><big>)</big></dt>
<dd><p><cite>file</cite> should not be tagged with <cite>tag</cite> after call, regardless of
whether it was before.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">mktag</tt><big>(</big><em>tag</em><big>)</big></dt>
<dd><p><cite>tag</cite> is created.  Do nothing if it exists.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">rmtag</tt><big>(</big><em>tag</em><big>)</big></dt>
<dd><p><cite>tag</cite> is removed.  Do nothing if it doesn&#8217;t exist.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">listtags</tt><big>(</big><em>file</em><big>)</big></dt>
<dd><p>Return a list of all of the tags of <cite>file</cite>.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">find</tt><big>(</big><em>tags</em><big>)</big></dt>
<dd><p>Return a list of files that have all of the given tags in <cite>tags</cite>.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">mount</tt><big>(</big><em>path</em>, <em>tree</em><big>)</big></dt>
<dd><p>Mount a virtual representation of the library representation <cite>tree</cite>
at <cite>path</cite>.</p>
</dd></dl>

</div>
<div class="section" id="implementation-specifics">
<h2>Implementation specifics<a class="headerlink" href="#implementation-specifics" title="Permalink to this headline">¶</a></h2>
<p>This section contains additional information about dantalian&#8217;s library
implementation.</p>
<p>Directories are tags, and vice versa.  Objects tagged with a given tag
are hard linked under the respective directory.  A file can appear
within a directory multiple times; such a file will be considered as
tagged once with the corresponding tag.</p>
<p>Due to practical reasons, there is a directory <tt class="docutils literal"><span class="pre">.dantalian</span></tt> in the
library root directory reserved for internal use.  It is treated
normally, i.e., as a directory and as a tag, but in almost all cases it
should not be used as a tag and should be considered an implementation
detail.</p>
<p>Everywhere a tag is needed in a library&#8217;s method calls, a path to a directory
can be substituted.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Library Specification</a><ul>
<li><a class="reference internal" href="#library-sublayer">Library Sublayer</a></li>
<li><a class="reference internal" href="#library-objects">Library objects</a></li>
<li><a class="reference internal" href="#tagging">Tagging</a></li>
<li><a class="reference internal" href="#library-class-and-methods">Library class and methods</a></li>
<li><a class="reference internal" href="#implementation-specifics">Implementation specifics</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="build.html"
                        title="previous chapter">Building</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="libop.html"
                        title="next chapter">Library Implementation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/dev/library.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="libop.html" title="Library Implementation"
             >next</a> |</li>
        <li class="right" >
          <a href="build.html" title="Building"
             >previous</a> |</li>
        <li><a href="../index.html">dantalian 0.5-dev documentation</a> &raquo;</li>
          <li><a href="../dev.html" >Developer Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, darkfeline.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>